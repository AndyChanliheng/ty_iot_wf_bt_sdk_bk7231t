# 电量统计单插（ PID：aumib22ytuftcydk） 

## 1.硬件IO口说明
	(1)继电器:PWM5,高电平有效;
	
	(2)开关按键:PWM3,低电平有效;
	
	(3)wifi指示灯:PWM0,低电平有效;
	
	(4)计量部分信息:工作电压220V,过流点17A,采样电阻１毫欧;计量芯片:bl0937;
	
	(5)电量统计(CF):PWM1;电流电压检测(CF１):PWM2;电流电压切换(SEL):PWM4,电平为直连模式；

## 2.网络状态对应指示灯
	(1)未配网:指示继电器状态；
	
	(2)配网中:快闪（２５０ｍｓ闪烁）和慢闪（１５００ｍｓ闪烁）；	
	
	(3)配网失败:指示继电器状态；
	
	(4)配网成功:指示继电器状态；

## 3.其他功能

	(1)wifi模式为WCM_OLD_LOW，上电低功耗模式，长按按键5秒进入配网模式；
	
	(2)上电默认为断电状态；

## 4.文件说明

	（1）device.h/device.c:主要是模块框架部分的头文件和功能，主要包含设备初始化，产测部分的回调，app操作部分的回调等；
	
	（2）app_switch.h/app_switch.c:这部分主要是开关部分的头文件和功能逻辑，主要包括硬件按键操作对应开关状态的显示，app操作对应开关状态的显示，指示灯的显示，倒计时功能等；
	
	（3）app_dltj.c/app_dltj.h:这部分是电量统计的应用层的头文件和功能代码，主要电量实时参数（电流电压功率）上报逻辑和对应的事件处理，电量增量上报逻辑/离线电量存储/未配网状态下电量的存储等；
	
	（4）bl0937.h/bl0937.c：这部分是电量统计芯片bl0937的驱动部分，主要是芯片的硬件初始化/电流电压功率电量的计算/产测部分的处理等；
